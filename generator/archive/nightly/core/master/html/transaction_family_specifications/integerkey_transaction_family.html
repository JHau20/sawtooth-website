

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>IntegerKey Transaction Family &mdash; Sawtooth latest documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="XO Transaction Family" href="xo_transaction_family.html" />
    <link rel="prev" title="BlockInfo Transaction Family" href="blockinfo_transaction_family.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../contents.html" class="icon icon-home" alt="Documentation Home"> Sawtooth
          

          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../app_developers_guide.html">Application Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">Architecture Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../transaction_family_specifications.html">Transaction Family Specifications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="settings_transaction_family.html">Settings Transaction Family</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity_transaction_family.html">Identity Transaction Family</a></li>
<li class="toctree-l2"><a class="reference internal" href="blockinfo_transaction_family.html">BlockInfo Transaction Family</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">IntegerKey Transaction Family</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#state">State</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#addressing">Addressing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#transaction-payload">Transaction Payload</a></li>
<li class="toctree-l3"><a class="reference internal" href="#transaction-header">Transaction Header</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#inputs-and-outputs">Inputs and Outputs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#family">Family</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#execution">Execution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="xo_transaction_family.html">XO Transaction Family</a></li>
<li class="toctree-l2"><a class="reference internal" href="validator_registry_transaction_family.html">PoET Validator Registry Transaction Family</a></li>
<li class="toctree-l2"><a class="reference internal" href="smallbank_transaction_family.html">Smallbank Transaction Family</a></li>
<li class="toctree-l2"><a class="reference external" href="https://sawtooth.hyperledger.org/docs/sabre/nightly/master/">Sawtooth Sabre Transaction Family</a></li>
<li class="toctree-l2"><a class="reference external" href="https://sawtooth.hyperledger.org/docs/seth/nightly/master/">Sawtooth Seth Transaction Family</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sysadmin_guide.html">System Administrator’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_references.html">SDK and API References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">CLI Command Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../contents.html">Sawtooth</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../contents.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../transaction_family_specifications.html">Transaction Family Specifications</a> &raquo;</li>
        
      <li>IntegerKey Transaction Family</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/transaction_family_specifications/integerkey_transaction_family.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="integerkey-transaction-family">
<h1>IntegerKey Transaction Family<a class="headerlink" href="#integerkey-transaction-family" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The IntegerKey transaction family allows users to set, increment, and decrement
the value of entries stored in a state dictionary.</p>
<p>An IntegerKey family transaction request is defined by the following values:</p>
<ul class="simple">
<li><p>A verb which describes what action the transaction takes</p></li>
<li><p>A name of the entry that is to be set or changed</p></li>
<li><p>A value by which the entry will be set or changed</p></li>
</ul>
<p>The ‘set’ verb is used to create new entries. The initial value of the entry will be
set to the value specified in the transaction request. The ‘inc’ and ‘dec’ verbs are
used to change the value of existing entries in the state dictionary.</p>
</div>
<div class="section" id="state">
<h2>State<a class="headerlink" href="#state" title="Permalink to this headline">¶</a></h2>
<p>This section describes in detail how IntegerKey transaction information is stored
and addressed.</p>
<p>The address values of IntegerKey transaction family entries are stored in state as
a CBOR encoded dictionary, with the key being the <em>Name</em> and the value being an integer
<em>Value</em>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cbor</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span>
    <span class="c1"># The name of the entry : The current value of the entry</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span><span class="s1">&#39;Value&#39;</span>
<span class="p">})</span>
</pre></div>
</div>
<p><em>Names</em> and <em>Values</em> must conform to the following rules:</p>
<ul class="simple">
<li><p>Valid <em>Names</em> are utf-8 encoded strings with a maximum of 20 characters</p></li>
<li><p>Valid <em>Values</em> must be integers in the range of 0 through 2<sup>32</sup> - 1 (32-bit unsigned int)</p></li>
</ul>
<div class="section" id="addressing">
<h3>Addressing<a class="headerlink" href="#addressing" title="Permalink to this headline">¶</a></h3>
<p>IntegerKey data is stored in the state dictionary using addresses which are generated from the IntegerKey namespace prefix and the unique name of the IntegerKey entry. Addresses will adhere to the following format:</p>
<ul class="simple">
<li><p>Addresses must be a 70 character hexadecimal string</p></li>
<li><p>The first 6 characters of the address are the first 6 characters of a sha512 hash of the IntegerKey namespace prefix: “intkey”</p></li>
<li><p>The following 64 characters of the address are the last 64 characters of a sha512 hash of the entry <em>Name</em></p></li>
</ul>
<p>For example, an IntegerKey address could be generated as follows:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hashlib</span><span class="o">.</span><span class="n">sha512</span><span class="p">(</span><span class="s1">&#39;intkey&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">+</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha512</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()[</span><span class="o">-</span><span class="mi">64</span><span class="p">:]</span>
<span class="go">&#39;1cf126cc488cca4cc3565a876f6040f8b73a7b92475be1d0b1bc453f6140fba7183b9a&#39;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Due to the possibility of hash collisions, there may be multiple <em>Names</em> in the state dictionary with the same address.</p>
</div>
</div>
</div>
<div class="section" id="transaction-payload">
<h2>Transaction Payload<a class="headerlink" href="#transaction-payload" title="Permalink to this headline">¶</a></h2>
<p>IntegerKey transaction request payloads are defined by the following CBOR data format:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cbor</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span>
    <span class="c1"># Describes the action the transaction takes, either &#39;set&#39;, &#39;inc&#39;, or &#39;dec&#39;</span>
    <span class="s1">&#39;Verb&#39;</span><span class="p">:</span> <span class="s1">&#39;verb&#39;</span><span class="p">,</span>

    <span class="c1"># The variable name of the entry which is to be modified</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span>

    <span class="c1"># The amount to set, increment, or decrement</span>
    <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="mi">1234</span><span class="p">,</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="transaction-header">
<h2>Transaction Header<a class="headerlink" href="#transaction-header" title="Permalink to this headline">¶</a></h2>
<div class="section" id="inputs-and-outputs">
<h3>Inputs and Outputs<a class="headerlink" href="#inputs-and-outputs" title="Permalink to this headline">¶</a></h3>
<p>The inputs for IntegerKey family transactions must include:</p>
<ul class="simple">
<li><p>Address of the <em>Name</em> being changed or added</p></li>
</ul>
<p>The outputs for IntegerKey family transactions must include:</p>
<ul class="simple">
<li><p>Address of the <em>Name</em> being changed or added</p></li>
</ul>
</div>
<div class="section" id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>List of transaction <em>header_signatures</em> that are required dependencies
and must be processed prior to processing this transaction</p></li>
</ul>
<p>For example, the ‘inc’ and ‘dec’ transactions must list the initial ‘set’ transaction for the entry. If an ‘inc’ or ‘dec’ transaction is ordered before the corresponding ‘set’ transaction (without listing the ‘set’ transaction as a dependency), they will be considered invalid (because <em>Name</em> will not exist when they are processed).</p>
</div>
<div class="section" id="family">
<h3>Family<a class="headerlink" href="#family" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>family_name: “intkey”</p></li>
<li><p>family_version: “1.0”</p></li>
</ul>
</div>
</div>
<div class="section" id="execution">
<h2>Execution<a class="headerlink" href="#execution" title="Permalink to this headline">¶</a></h2>
<p>The IntegerKey transaction processor receives a transaction request and a state dictionary.</p>
<p>If the payload of the transaction request is empty, the transaction is invalid.</p>
<p>The address for the transaction is generated using the algorithm stated in the Addressing
section of this document. If an encoding error occurs, the transaction is invalid.</p>
<p>The transaction request <em>Verb</em> , <em>Name</em>, and <em>Value</em> are checked. If any of these values are
empty, the transaction is invalid. <em>Verb</em> must be either ‘set’, ‘inc’, or ‘dec’.
<em>Name</em> must be a utf-8 encoded string with a maximum of 20 characters. <em>Value</em> must be
a 32-bit unsigned integer. If any of these checks fail, the transaction is invalid.</p>
<p>If the <em>Verb</em> is ‘set’, the state dictionary is checked to determine if the <em>Name</em> associated with the
transaction request already exists. If it does already exist, the transaction is invalid.
Otherwise the <em>Name</em> and <em>Value</em> are stored as a new entry in the state dictionary.</p>
<p>If the <em>Verb</em> is ‘inc’, the <em>Name</em> specified by the transaction request is checked determine
if the entry exists in the state dictionary. If the <em>Name</em> does not exist in the state dictionary,
it is an invalid transaction. Otherwise, we attempt to increment the <em>Value</em> in the state dictionary by the <em>Value</em> specified in the transaction request. If this incrementation would result in a value outside the range of 0 through 2<sup>32</sup> - 1 it is considered an invalid transaction. Otherwise, the <em>Value</em> in the state dictionary is incremented.</p>
<p>If the <em>Verb</em> is ‘dec’, the <em>Name</em> specified by the transaction request is checked determine
if the entry exists in the state dictionary. If the <em>Name</em> does not exist in the state dictionary, it is an invalid transaction. Otherwise, we attempt to decrement the <em>Value</em> in the state dictionary by the <em>Value</em> specified in the transaction request. If this decrementation would result in a value outside the range of 0 through 2<sup>32</sup> - 1, it is considered an invalid transaction. Otherwise, the <em>Value</em> in the state dictionary is decremented.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="xo_transaction_family.html" class="btn btn-neutral float-right" title="XO Transaction Family" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="blockinfo_transaction_family.html" class="btn btn-neutral float-left" title="BlockInfo Transaction Family" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2015-2017, Intel Corporation

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>