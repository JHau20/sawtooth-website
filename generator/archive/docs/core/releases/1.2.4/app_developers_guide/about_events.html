

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>About Sawtooth Events &mdash; Sawtooth v1.2.4 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="About Event Subscriptions" href="about_event_subscriptions.html" />
    <link rel="prev" title="Subscribing to Events" href="event_subscriptions.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../contents.html" class="icon icon-home"> Sawtooth
          

          
          </a>

          
            
            
              <div class="version">
                v1.2.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../app_developers_guide.html">Application Developer’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">Transaction Family Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="installing_sawtooth.html">Setting Up a Sawtooth Node for Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating_sawtooth_network.html">Creating a Sawtooth Test Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_xo_transaction_family.html">Playing with the XO Transaction Family</a></li>
<li class="toctree-l2"><a class="reference internal" href="using_the_sdks.html">Using the Sawtooth SDKs</a></li>
<li class="toctree-l2"><a class="reference internal" href="no_sdk.html">Development Without an SDK</a></li>
<li class="toctree-l2"><a class="reference internal" href="address_and_namespace.html">Address and Namespace Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="namespace_restriction.html">Namespace Restriction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="event_subscriptions.html">Subscribing to Events</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">About Sawtooth Events</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#event-namespace">Event Namespace</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-an-application-specific-event">Example: An Application-specific Event</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="about_event_subscriptions.html">About Event Subscriptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="zmq_event_subscription.html">Using ZMQ to Subscribe to Events</a></li>
<li class="toctree-l3"><a class="reference internal" href="web_socket_event_subscription.html">About Web Sockets and Event Subscriptions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">Architecture Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transaction_family_specifications.html">Transaction Family Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sysadmin_guide.html">System Administrator’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_references.html">SDK and API References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">CLI Command Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../contents.html">Sawtooth</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../contents.html">Docs</a> &raquo;</li>
        
          <li><a href="../app_developers_guide.html">Application Developer’s Guide</a> &raquo;</li>
        
          <li><a href="event_subscriptions.html">Subscribing to Events</a> &raquo;</li>
        
      <li>About Sawtooth Events</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/app_developers_guide/about_events.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="about-sawtooth-events">
<h1>About Sawtooth Events<a class="headerlink" href="#about-sawtooth-events" title="Permalink to this headline">¶</a></h1>
<p>Sawtooth events occur when blocks are committed — that is, the validator
broadcasts events when a commit operation succeeds — and are not persisted in
state. Each transaction family can define the events that are appropriate for
its business logic.</p>
<p>An event has three parts:</p>
<ul class="simple">
<li><p>Event type (the name of the event)</p></li>
<li><p>Opaque payload whose structure is defined by the event type</p></li>
<li><p>List of attributes</p></li>
</ul>
<p>An attribute is a key-value pair that contains transparent metadata about the
event. The key is the name of the attribute, and the value is the specific
contents for that key. The same key can be used for multiple attributes in an
event.</p>
<p>It is important to define meaningful event attributes, so that the attributes
can be used to filter event subscriptions. Note that although attributes are not
required, an event filter cannot operate on an event without attributes. For
more information, see <a class="reference internal" href="about_event_subscriptions.html"><span class="doc">About Event Subscriptions</span></a>.</p>
<p>Events are represented with the following protobuf message:</p>
<div class="highlight-protobuf notranslate"><div class="highlight"><pre><span></span><span class="kd">message</span> <span class="nc">Event</span> <span class="p">{</span>
  <span class="c1">// Used to subscribe to events and servers as a hint for how to deserialize</span>
  <span class="c1">// event_data and what pairs to expect in attributes.</span>
  <span class="kt">string</span> <span class="na">event_type</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

  <span class="c1">// Transparent data defined by the event_type.</span>
  <span class="kd">message</span> <span class="nc">Attribute</span> <span class="p">{</span>
    <span class="kt">string</span> <span class="na">key</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">string</span> <span class="na">value</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">repeated</span> <span class="n">Attribute</span> <span class="na">attributes</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

  <span class="c1">// Opaque data defined by the event_type.</span>
  <span class="kt">bytes</span>  <span class="na">data</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">event_type</span></code> field (the name of the event) is used to determine how opaque
(application-specific) data has been serialized and what transparent event
attributes to expect.</p>
<p>For more information, see
<a class="reference internal" href="../architecture/events_and_transactions_receipts.html"><span class="doc">Events and Transaction Receipts</span></a>.</p>
<div class="section" id="event-namespace">
<h2>Event Namespace<a class="headerlink" href="#event-namespace" title="Permalink to this headline">¶</a></h2>
<p>By convention, event names use the transaction family as a prefix, such as
<code class="docutils literal notranslate"><span class="pre">xo/create</span></code> for a create event from the XO transaction family.</p>
<p>Core Sawtooth events are prefixed with <code class="docutils literal notranslate"><span class="pre">sawtooth/</span></code>. The core events are:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sawtooth/block-commit</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sawtooth/state-delta</span></code></p></li>
</ul>
</div></blockquote>
<div class="section" id="sawtooth-block-commit">
<h3>sawtooth/block-commit<a class="headerlink" href="#sawtooth-block-commit" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">sawtooth/block-commit</span></code> event occurs when a block is committed. This event
contains information about the block, such as the block ID, block number, state
root hash, and previous block ID. It has the following structure:</p>
<div class="highlight-protobuf notranslate"><div class="highlight"><pre><span></span><span class="n">Event</span> <span class="p">{</span>
  <span class="na">event_type</span> <span class="o">=</span> <span class="s">&quot;sawtooth/block-commit&quot;</span><span class="p">,</span>
  <span class="na">attributes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Attribute</span> <span class="p">{</span> <span class="na">key</span> <span class="o">=</span> <span class="s">&quot;block_id&quot;</span><span class="p">,</span> <span class="na">value</span> <span class="o">=</span> <span class="s">&quot;abc...123&quot;</span> <span class="p">},</span>
    <span class="n">Attribute</span> <span class="p">{</span> <span class="na">key</span> <span class="o">=</span> <span class="s">&quot;block_num&quot;</span><span class="p">,</span> <span class="na">value</span> <span class="o">=</span> <span class="s">&quot;523&quot;</span> <span class="p">},</span>
    <span class="n">Attribute</span> <span class="p">{</span> <span class="na">key</span> <span class="o">=</span> <span class="s">&quot;state_root_hash&quot;</span><span class="p">,</span> <span class="na">value</span> <span class="o">=</span> <span class="s">&quot;def...456&quot;</span> <span class="p">},</span>
    <span class="n">Attribute</span> <span class="p">{</span> <span class="na">key</span> <span class="o">=</span> <span class="s">&quot;previous_block_id&quot;</span><span class="p">,</span> <span class="na">value</span> <span class="o">=</span> <span class="s">&quot;acf...146&quot;</span> <span class="p">},</span>
  <span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="sawtooth-state-delta">
<h3>sawtooth/state-delta<a class="headerlink" href="#sawtooth-state-delta" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">sawtooth/state-delta</span></code> occurs when a block is committed. This event contains
all state changes that occurred at a given address for that block. This event
has the following structure:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Event</span> <span class="p">{</span>
  <span class="n">event_type</span> <span class="o">=</span> <span class="s2">&quot;sawtooth/state-delta&quot;</span><span class="p">,</span>
  <span class="n">attributes</span> <span class="o">=</span> <span class="p">[</span><span class="n">Attribute</span> <span class="p">{</span> <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;address&quot;</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;abc...def&quot;</span> <span class="p">}],</span>
  <span class="n">event_data</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">bytes</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that the addresses that match the filter are in the attributes. Changed
values are part of the event data.</p>
</div>
</div>
<div class="section" id="example-an-application-specific-event">
<h2>Example: An Application-specific Event<a class="headerlink" href="#example-an-application-specific-event" title="Permalink to this headline">¶</a></h2>
<p>The XO transaction family could define an <code class="docutils literal notranslate"><span class="pre">xo/create</span></code> event that is sent when
a game has been created. The following examples show a simple <code class="docutils literal notranslate"><span class="pre">xo/create</span></code>
event in several languages.</p>
<p>Python example:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">context</span><span class="o">.</span><span class="n">add_event</span><span class="p">(</span>
    <span class="s2">&quot;xo/create&quot;</span><span class="p">,</span> <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
        <span class="s1">&#39;creator&#39;</span><span class="p">:</span> <span class="n">signer_public_key</span>
<span class="p">})</span>
</pre></div>
</div>
</div></blockquote>
<p>Go example:</p>
<blockquote>
<div><div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="nx">attributes</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="nx">processor</span><span class="p">.</span><span class="nx">Attribute</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="nx">attributes</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">attributes</span><span class="p">,</span> <span class="nx">processor</span><span class="p">.</span><span class="nx">Attribute</span><span class="p">{</span>
  <span class="nx">Key</span><span class="p">:</span>   <span class="s">&quot;name&quot;</span><span class="p">,</span>
  <span class="nx">Value</span><span class="p">:</span> <span class="nx">name</span><span class="p">,</span>
<span class="p">})</span>
<span class="nx">attributes</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">attributes</span><span class="p">,</span> <span class="nx">processor</span><span class="p">.</span><span class="nx">Attribute</span><span class="p">(</span>
  <span class="nx">Key</span><span class="p">:</span>   <span class="s">&quot;creator&quot;</span><span class="p">,</span>
  <span class="nx">Value</span><span class="p">:</span> <span class="nx">signer_public_key</span><span class="p">,</span>
<span class="p">})</span>
<span class="kd">var</span> <span class="nx">empty</span> <span class="p">[]</span><span class="kt">byte</span>
<span class="nx">context</span><span class="p">.</span><span class="nx">AddEvent</span><span class="p">(</span>
  <span class="s">&quot;xo/create&quot;</span><span class="p">,</span>
  <span class="nx">attributes</span><span class="p">,</span>
  <span class="nx">empty</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>JavaScript example:</p>
<blockquote>
<div><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">context</span><span class="p">.</span><span class="nx">addEvent</span><span class="p">(</span>
  <span class="s1">&#39;xo/create&#39;</span><span class="p">,</span>
  <span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="nx">name</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;creator&#39;</span><span class="p">,</span> <span class="nx">signer_public_key</span><span class="p">]],</span>
  <span class="kc">null</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>Rust example:</p>
<blockquote>
<div><div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="n">context</span><span class="p">.</span><span class="n">add_event</span><span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="s">&quot;xo/create&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span><span class="w"></span>
<span class="w">  </span><span class="n">vec</span><span class="o">!</span><span class="p">[(</span><span class="s">&quot;name&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span><span class="w"> </span><span class="n">name</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;creator&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span><span class="w"> </span><span class="n">signer_public_key</span><span class="p">)],</span><span class="w"></span>
<span class="w">  </span><span class="n">vec</span><span class="o">!</span><span class="p">[].</span><span class="n">as_slice</span><span class="p">())</span><span class="w"></span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="about_event_subscriptions.html" class="btn btn-neutral float-right" title="About Event Subscriptions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="event_subscriptions.html" class="btn btn-neutral float-left" title="Subscribing to Events" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2017, Intel Corporation

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>