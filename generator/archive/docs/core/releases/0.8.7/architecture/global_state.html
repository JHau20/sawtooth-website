

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Global State &mdash; Sawtooth v0.8.7 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Sawtooth v0.8.7 documentation" href="../index.html"/>
        <link rel="up" title="Architecture" href="../architecture.html"/>
        <link rel="next" title="Journal" href="journal.html"/>
        <link rel="prev" title="Transactions and Batches!" href="transactions_and_batches.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../contents.html" class="icon icon-home"> Sawtooth
          

          
          </a>

          
            
            
              <div class="version">
                v0.8.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../architecture.html">Architecture</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="transactions_and_batches.html">Transactions and Batches!</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Global State</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#radix-merkle-tree-overview">Radix Merkle Tree Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#merkle-hashes">Merkle Hashes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#radix-addresses">Radix Addresses</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#serialization-concerns">Serialization Concerns</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="journal.html">Journal</a></li>
<li class="toctree-l2"><a class="reference internal" href="rest_api.html">REST API</a></li>
<li class="toctree-l2"><a class="reference internal" href="poet.html">PoET 1.0 Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="validator_network.html">Validator Network</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../app_developers_guide.html">Application Developer&#8217;s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_developers_guide.html">Core Developer&#8217;s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sysadmin_guide.html">System Administrator&#8217;s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rest_api.html">REST API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">CLI Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transaction_family_specifications.html">Transaction Family Specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../contents.html">Sawtooth</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../contents.html">Docs</a> &raquo;</li>
        
          <li><a href="../architecture.html">Architecture</a> &raquo;</li>
        
      <li>Global State</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/architecture/global_state.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="global-state">
<h1>Global State<a class="headerlink" href="#global-state" title="Permalink to this headline">¶</a></h1>
<p>One goal of a distributed ledger like Sawtooth, indeed the
<em>defining</em> goal, is to distribute a ledger among participating nodes.
The ability to ensure a consistent copy of data amongst nodes in
Byzantine consensus is one of the core strengths of blockchain technology.</p>
<p>Sawtooth represents state for all transaction families in a single
instance of a Radix Merkle Tree on each validator. The process of block
validation on each validator ensures that the same transactions result
in the same state transitions and that the resulting data is the same
for all participants in the network.</p>
<p>The state is split into namespaces which allow flexibility for
transaction family authors to define, share, and reuse global state data
between transaction processors.</p>
<div class="section" id="radix-merkle-tree-overview">
<h2>Radix Merkle Tree Overview<a class="headerlink" href="#radix-merkle-tree-overview" title="Permalink to this headline">¶</a></h2>
<div class="section" id="merkle-hashes">
<h3>Merkle Hashes<a class="headerlink" href="#merkle-hashes" title="Permalink to this headline">¶</a></h3>
<p>Sawtooth uses an addressable Radix Merkle tree to store data for
transaction families. Let&#8217;s break that down: The tree is a Merkle tree because
it is a copy-on-write data structure which stores successive node hashes
from leaf-to-root upon any changes to the tree. For a given set of state
transitions associated with a block, we can generate a single root hash
which points to that <em>version</em> of the tree. By placing this state root
hash on the block header, we can gain consensus on the expected version
of state <em>in addition to</em> the consensus on the chain of blocks. If a
validator&#8217;s state transitions for a block result in a different hash,
the block is not considered valid. For more information about general
concepts, see the <a class="reference external" href="https://en.wikipedia.org/wiki/Merkle_tree">Merkle</a> page on wikipedia.</p>
<a class="reference internal image-reference" href="../_images/state_merkle_hashes.svg"><div align="center" class="align-center"><img alt="Merkle hash diagram" src="../_images/state_merkle_hashes.svg" width="80%" /></div>
</a>
</div>
<div class="section" id="radix-addresses">
<h3>Radix Addresses<a class="headerlink" href="#radix-addresses" title="Permalink to this headline">¶</a></h3>
<a class="reference internal image-reference" href="../_images/state_address_format.svg"><div align="center" class="align-center"><img alt="Tree address format" src="../_images/state_address_format.svg" width="80%" /></div>
</a>
<p>The tree is an addressable Radix tree because addresses uniquely
identify the paths to leaf nodes in the tree where information is
stored. An address is a hex-encoded 70 character string representing
35 bytes. In the tree implementation, each byte is a Radix path segment which
identifies the next node in the path to the leaf containing the data
associated with the address. The address format contains a 3 byte
(6 hex character) namespace prefix which provides 2<sup>24</sup>
(16,777,216) possible different namespaces in a given instance of
Sawtooth. The remaining 32 bytes (64 hex characters) are encoded
based on the specifications of the designer of the namespace, and may
include schemes for subdividing further, distinguising object types,
and mapping domain-specific unique identifiers into portions of the address.
For more information about general concepts, see the <a class="reference external" href="https://en.wikipedia.org/wiki/Radix_tree">Radix</a> page on
wikipedia.</p>
<a class="reference internal image-reference" href="../_images/state_radix.svg"><div align="center" class="align-center"><img alt="Radix addressing diagram" src="../_images/state_radix.svg" width="80%" /></div>
</a>
</div>
</div>
<div class="section" id="serialization-concerns">
<h2>Serialization Concerns<a class="headerlink" href="#serialization-concerns" title="Permalink to this headline">¶</a></h2>
<p>In addition to questions regarding the encoding of addresses,
namespace designers also need to define the mechanism of serialization
and the rules for serializing/deserializing the data stored at addresses.
The domain-specific Transaction Processor makes get(address) and
set(address, data) calls against a version of state that the validator
provides. get(address) returns the byte array found at that address
and set(address, data) sets the byte array stored at that address.
The byte array is opaque to the core system. It only has meaning when
deserialized by a domain-specific component based on the rules of the
namespace. It is critical to select a serialization scheme which is
deterministic across executions of the transaction, across platforms, and
across versions of the serialization framework. Data strucutres which don&#8217;t
enforce ordered serialization (e.g. sets, maps, dicts) should be
avoided. The requirement is to consistently produce the same byte array
across space and time. If the same byte array is not produced, the leaf
node hash containing the data will differ, as will every parent node back
to the root. This will result in transactions and the blocks that contain
them being considered valid on some validators and invalid on others,
depending on the non-deterministic behavior. This is considered bad
form.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="journal.html" class="btn btn-neutral float-right" title="Journal" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="transactions_and_batches.html" class="btn btn-neutral" title="Transactions and Batches!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2017, Intel Corporation.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'v0.8.7',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>